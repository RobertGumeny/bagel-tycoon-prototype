epics:
  - id: EPIC-1
    title: "Game Engine Foundations"
    status: TODO
    tasks:
      - id: BT-001
        title: "Type Definitions & Core Constants"
        description: "Establish the type-safe foundation for the shop simulation. Reference PRD for specific station names/costs."
        requirements:
          - "Define interfaces for GameState, StationState, Recipe, and Order."
          - "Create a STATION_CONFIGS constant mapping all 6 stations to their unlock costs."
          - "Implement STORAGE_CAPS constant for levels 1-3 (3, 5, 8 ingredients)."
          - "Export formula constants: 1.6x multiplier for upgrades and 0.12x for quality."
        status: DONE

      - id: BT-002
        title: "Engine Class & Observable Pattern"
        description: "Build the logic core. Ensure strict decoupling from React."
        requirements:
          - "Implement a singleton BagelTycoonEngine class."
          - "Create a subscribe() method and a private notify() system for state updates."
          - "Add public methods for takeOrder(), unlockStation(), and upgradeStation()."
          - "Zero dependencies on DOM or React-specific hooks/state."
        status: DONE

      - id: BT-003
        title: "100ms Tick & Persistence"
        description: "Manage the passage of time and data safety."
        requirements:
          - "Implement an internal setInterval running at 100ms for logic updates."
          - "Implement auto-save logic to localStorage every 5 seconds."
          - "Ensure the Engine hydrates its state from localStorage on instantiation."
          - "Tick down activeOrder.remainingTime and emit updates every tick."
        status: DONE

      - id: BT-004
        title: "Unit Tests for Engine Core"
        description: "Ensure reliability of foundational logic for simulation."
        requirements:
          - "Write tests for order processing time calculations (parallel vs. series)."
          - "Test customer spawning logic and queue management."
          - "Validate upgrade cost calculations and station unlocks."
          - "Ensure state persistence and hydration works as expected."
        status: DONE

  - id: EPIC-2
    title: "Core Simulation & Logic"
    status: DONE
    tasks:
      - id: BT-005
        title: "Customer Queue & Spawning"
        description: "Simulate shop traffic flow."
        requirements:
          - "Spawn one customer every 5 seconds if the queue length is < 5."
          - "Store queue as an array of unique emoji-based customer IDs."
          - "Implement takeOrder() to shift from queue to activeOrder state."
        status: DONE

      - id: BT-006
        title: "Dynamic Order Generation"
        description: "Build orders based on current shop capabilities."
        requirements:
          - "Filter Recipes by 'unlocked' status of both Stations and Ingredients."
          - "Implement 60% probability check for adding a beverage to any food order."
          - "Calculate totalBaseTime as the sum of all components in the order."
        status: DONE

      - id: BT-007
        title: "Processing Logic (Parallel vs. Series)"
        description: "Apply station efficiency and manager automation logic."
        requirements:
          - "Apply speed multiplier: baseTime / (1 + (level - 1) * 0.25)."
          - "If all stations in order have managers: process in parallel (use max station time)."
          - "If any station lacks a manager: process in series (use sum of station times)."
        status: DONE

      - id: BT-008
        title: "Pricing & Speed Bonus Logic"
        description: "Calculate final payout based on performance."
        requirements:
          - "Sum qualityMultiplier: 1 + total of ((stationQuality - 1) * 0.12)."
          - "Calculate speedBonus: 1.5x (<50% time), 1.2x (<100%), 1.0x (normal), 0.7x (slow)."
          - "Log completed sales to salesHistory with bonus label and final dollar amount."
        status: DONE

  - id: EPIC-3
    title: "React UI Layer (POS Style)"
    status: IN_PROGRESS
    tasks:
      - id: BT-009
        title: "POS Layout & Shell"
        description: "Build the visual container."
        requirements:
          - "2-column layout (Sidebar: 33%, Main: 66%) using Tailwind CSS."
          - "Header component displaying Logo and real-time Money counter."
          - "Implement random tagline rotation from the PRD pool on every mount."
        status: DONE

      - id: BT-010
        title: "Active Order & Queue UI"
        description: "Visualize shop activity."
        requirements:
          - "Render 5 slots for CustomerQueue using emoji avatars."
          - "ActiveOrder displays order name, countdown timer, and a progress bar."
          - "Progress bar must fill smoothly based on 100ms engine updates."
        status: DONE

      - id: BT-011
        title: "Station Grid & Modals"
        description: "Build the management interface."
        requirements:
          - "Render 2x3 grid of color-coded station cards using PRD palette."
          - "StationModal includes 2 columns: Equipment upgrades and Quality upgrades."
          - "Display 'Ingredient Tags' and a button to unlock the next ingredient in sequence."
          - "Hide upgrade buttons if player lacks sufficient funds."
        status: TODO
